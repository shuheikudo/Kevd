# Kevd
K用に最適化されたLAPACKのDSYEVDです。データレイアウトを工夫することで、メモリアクセスパターンを単純化して、ピークメモリバンド幅に近いメモリ性能を引き出せるよう、工夫されています。
あまり優秀でないコンパイラでもまっとうなコードが吐けるよう、複雑なことをしていません（できません）。そのため、大変苦しいコードになっています。

データ構造は、本質的にはSOAOSOAとなっていると思います。内側から、SIMD幅とブロック化と、三角行列の端数処理ということです。ちゃんと構造体を使って表現するべきですが、コンパイラに対する信頼感があればの話です。

主要なコードは、マクロとして書かれています。SIMD変数を引数とするインライン関数がちゃんとコンパイルされるか、不明であったため、すべて自動的にインライン化するようにしています。そのため、とくにdormtrbはコンパイルにとても時間がかかります。

LAPACKのコードを参考に作ったものが多いですが、その後、一から書き直したため、LAPACKのソースコードが残っているものは少ないです。
